# Chat Box

## 一、目标

开发一个轻量化 **Prompt 原型设计工具**，支持快速测试不同提示词策略，并能直观对比模型原始输出与渲染结果。

技术选型：Next.js + Tailwind + LangChain + OpenAI + Python 后端

最后需要暴露出单一的启动脚本，方便部署。


## 二、核心功能

### 1. 基础设置

* **BaseURL / APIKey 管理**

  * 用户输入自定义 `baseurl` 和 `apikey`（支持 OpenAI 协议）。
  * 后端通过 **LangChain 封装的 OpenAI API** 进行通讯。
* **模型选择**

  * 支持在前端配置 `model` 参数（如 gpt-4o-mini / gpt-4o / 自建模型）。

### 2. 聊天界面

* **双栏显示**

  * 左侧：显示模型原始返回内容（raw text）。
  * 右侧：显示渲染后的 **Markdown 版本**（代码块、表格、公式可视化）。
* **对话管理**

  * 支持多轮对话，状态存储在前端。
  * 每条消息支持展开/折叠原始 JSON 响应（便于调试 tokens/usage）。

### 3. 手动编辑对话

* **添加对话轮次**

  * 点击「+」按钮，手动输入一条对话（指定角色：system / user / assistant / other）。
* **编辑历史消息**

  * 支持点击修改过去的某条消息内容（例如调整 prompt）。
* **删除消息**

  * 支持删除任意历史对话，方便清理与重构对话流。


## 三、扩展功能（后期）

* **Prompt 版本管理**：可以保存不同版本的提示词并回溯效果。
* **多模型对比**：同一 prompt 下调用多个模型，结果并排显示。
* **标签化分析**：给生成的样本自动打上「短/长/遵循/不遵循」等标签。
* **简单指标**：统计每个 prompt 平均 token 长度、输出分布，辅助数据质量评估。

## 四、典型使用流程

1. 在设置里填入 BaseURL + APIKey，选择模型。
2. 观察左侧原始输出 & 右侧 Markdown 渲染。
3. 如果结果不理想 → 点击编辑该轮提示词 → 再次发送 → 快速迭代。
4. 需要构造不同质量数据 → 点击「+」新建一轮对话，手动标记角色（system / user）。


我的要求是一个简洁的对话页面，左侧显示纯文本 text 形式（需要标注行号），右侧显示正常的 markdown 格式，且可以点击打开 think 过程（也就是常规的网页对话的显示格式）。对于每一个对话轮次，由左右两个部分组成，两个 block 大小固定，内部可以滑动显示更多的部分。两个一起这个长条形的东西就是一个对话轮子（只是我们要求两种显示格式）其中纯文本的 block 是可编辑的。一个轮次的左侧是角色按钮，可以切换 assistant user system（这个最终影响到我们如何合并历史信息发送后续的请求，允许我们手动切换，设定上下文）。轮次的下方是 加号，生成，删除。加号代表创建一个空的轮次需要用户自己编辑内容（默认为 user）。生成代表用户可能更改了之前的上下文，需要发送请求让模型生成了，生成后自动创建一个 assistant 的轮次并将得到的回复填入。删除代表删除上面这个轮次。每个轮次都需要有这三个。在中间的轮次点击加号代表生成一个新的轮次插入下方（更改上下文），点击生成代表删除后面所